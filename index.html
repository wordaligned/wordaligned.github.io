<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="icon" href="/images/favicon.png" type="image/png"/>
<link href="/styles/application.css" media="all" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/scripts/prettify.js"></script>
<script type="text/javascript" src="/scripts/lang-lisp.js"></script>
<script type="text/javascript" src="http://www.haloscan.com/load/wordaligned"></script>

<title>Word Aligned</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="author" content="Thomas Guest" />
<meta name="description" content="A collection of articles on software development written by Thomas Guest." />
<meta name="keywords" content="CLRS, Regex, Missiles, Cycling, Agile, Self, Editors, Emacs, Primes, Torvalds, ImageMagick, Hoare, IDE, Decorators, Tests, Shell, PIL, Lcs, Turing, Javascript, Ruby on Rails, Puzzles, Europython, Characters, Pictures, Fractals, Crabs, Github, DocBook, Dynamic Languages, lighttpd, Bugs, CVS, Reviews, Steganography, Algorithms, Perec, Content, Markdown, Two Wheels, Conferences, Chess, Syntax, Unix, Arc, Go, Web-applications, Iphone, Web Applications, Java, Esr, Recursion, Charts, Perl, Subversion, Recommended, Animation, Teamwork, Build, ACCU, Knuth, Android, OCR, Boost, php, Erlang, Swansea, Python, cvs2svn, Scrum, SICP, Windows, Books, Awk, Graphics, Disqus, Ruby, openid, C, Zlib, Talks, Trac, Lisp, Documentation, C++, Etc, Streams, Bristol, Tesseract, Drawing, Accidents, Google, Apple, Functional Programming, Pi, Haskell, Design, Virtualization, Unicode, Spolsky, Oulipo, Curl, Scheme" />
<link rel="alternate" type="application/rss+xml" title="Feed" href="http://feeds.wordaligned.org/wordaligned" />
</head>

<body onload="prettyPrint()">
<div id="container">
  <div id="header">
<h1><span><a accesskey="h" href="/">Word Aligned</a></span></h1>
<h2>tales from the code face</h2>
<a class="button" href="http://feeds.wordaligned.org/wordaligned" title="Subscribe to Word Aligned"><img style="float: right;" src="/images/feed.png" alt="Feed Logo" height="28" width="28"/></a>
</div>

  <div id="page">
    <div id="content">
      <div class="atomentry" id="meetup-turn-up">
<h2 class="title"><a href="/articles/meetup-turn-up">Meetup? Turn Up!</a></h2>
<p class="meta"><abbr class="published" title="2018-01-18">2018-01-18</abbr> &bull; <a href="/tag/talks" rel="tag">Talks</a> &bull; <a href="/articles/meetup-turn-up#disqus_thread">Comments</a></p>
<p><a href="https://www.meetup.com/Agile-Bath-Bristol/events/245853715/"><img alt="Sell out" src="/images/agile-bb-meetup.png"/></a>
</p>
<p>Monday&#8217;s <a href="https://www.meetup.com/Agile-Bath-Bristol/events/245853715/">Agile Bath &amp; Bristol meetup</a> was a sell out. All 50 available spaces were taken. I myself was lucky to get a place &#8212; I was on the waiting list until a spot opened up at 3pm on the day. And I was the speaker!
</p>
<p>The reality turned out to be different: of the 50 who&#8217;d claimed spaces, roughly one in four actually showed up.
</p>
<p>I know, it was <a href="https://en.wikipedia.org/wiki/Blue_Monday_(date)">Blue Monday</a>. I know, there are bugs going round &#8212; my daughter has been running a fever and didn&#8217;t go in to college, and if I hadn&#8217;t been presenting I would have cancelled myself to stay in with her. I know, your work day over-runs, you&#8217;re hungry, something else comes up. I know, it&#8217;s a free event, so it&#8217;s not as though you&#8217;ve <em>lost</em> anything.
</p>
<p>Despite all these things a 25% turnout reflects badly on us all. It&#8217;s unfair on the sponsors and organisers, especially when refreshments are offered. It&#8217;s impolite to those who turn up at the advertised time, and must then sit waiting in case more people who&#8217;ve said they&#8217;re coming actually show up. It&#8217;s tough on the speakers: planning a session for an audience of 50 is different to one you&#8217;d plan for 12.
</p>
<p>I realise 25% is egregiously low, but &#8212; in my experience &#8212; 50% is far from unusual, and even considered acceptable. I think it&#8217;s shabby. The one excuse noone has is forgetting the event is on &#8212; Meetup etc. integrate with your calendar and issue repeated reminders to attend and requests to cancel if you cannot.
</p>
<p>So, my thanks to those who turned up and participated. I enjoyed it. Smaller numbers allowed for a more collaborative session. Ironically, topics discussed included punctuality, respect, commitment.
</p>
<p>Please, don&#8217;t sign up to a meetup you don&#8217;t plan to attend. If you decide to cancel, release your place so someone else can have it. Otherwise, arrive on time.
</p>

</div>


<div class="atomentry" id="advent-of-code-2017">
<h2 class="title"><a href="/articles/advent-of-code-2017">Advent of Code 2017</a></h2>
<p class="meta"><abbr class="published" title="2018-01-12">2018-01-12</abbr> &bull; <a href="/tag/puzzles" rel="tag">Puzzles</a>, <a href="/tag/python" rel="tag">Python</a> &bull; <a href="/articles/advent-of-code-2017#disqus_thread">Comments</a></p>
<p>A big thanks to <a href="http://was.tl">Eric Wastl</a> for another great <a href="http://adventofcode.com/2017">Advent of Code</a>. Inspired by <a href="https://github.com/norvig/pytudes/blob/master/ipynb/Advent%20of%20Code.ipynb">Peter Norvig</a>, I&#8217;ve published <a href="https://github.com/wordaligned/advent-of-code-2017/blob/master/advent-of-code-2017.ipynb">my solutions</a> as a Jupyter notebook.
</p>
<p><a href="https://github.com/wordaligned/advent-of-code-2017/blob/master/advent-of-code-2017.ipynb"><img src="https://raw.githubusercontent.com/wordaligned/advent-of-code-2017/8e8344b4c5fc00827e42576059f36389dcfa453c/done.png" alt="Done!"/></a>
</p>

</div>


<div class="atomentry" id="computer-world">
<h2 class="title"><a href="/articles/computer-world">Computer World</a></h2>
<p class="meta"><abbr class="published" title="2017-09-30">2017-09-30</abbr> &bull; <a href="/tag/apple" rel="tag">Apple</a>, <a href="/tag/self" rel="tag">Self</a>, <a href="/tag/design" rel="tag">Design</a> &bull; <a href="/articles/computer-world#disqus_thread">Comments</a></p>
<p><a data-flickr-embed="true"  href="https://www.flickr.com/photos/thomasguest/37406493811/in/dateposted-friend/" title="The Hitchhiker&#x27;s Guide to the Galaxy"><img src="https://farm5.staticflickr.com/4371/37406493811_0d17fab6cf.jpg" width="401" height="500" alt="The Hitchhiker&#x27;s Guide to the Galaxy"></a><script async src="//embedr.flickr.com/assets/client-code.js" charset="utf-8"></script>
</p>
<p>Douglas Adams&#8217; &#8220;Hitchhiker&#8217;s Guide to the Galaxy&#8221; tells the story of the two most powerful computers ever made. The first, Deep Thought, was designed to figure out the meaning of Life the Universe and Everything. After 7,500,000 years of processing it came up with the concise but unedifying Ultimate Answer of 42. It then undertook the task of designing its successor, a computer sophisticated enough to calculate the Ultimate Question:
</p>
<blockquote><p>&#8220;&#8230; A computer which can calculate the Question to the Ultimate Answer, a computer of such infinite and subtle complexity that organic life itself shall form part of its operational matrix &#8230; Yes! I shall design this computer for you. And I shall name it also unto you. And it shall be called &#8230; The Earth.&#8221;
</p>
</blockquote><p>When I first heard this it seemed ridiculous. Now, almost 40 years on, I&#8217;ve realised it&#8217;s true.
</p>
<p>It&#8217;s no longer correct to think of computers as discrete units. Computers have the property that when you connect two of them you get another computer, and so on. The network <strong>is</strong> the computer. The Apple in your hand, the Echo on your shelf, the chip in your <a href="https://www.amazon.co.uk/Scepticism-Inc-Bo-Fowler/dp/009927468X">shopping trolley</a> &#8212; all combine to form a global connected device. And as Adams predicted, we ourselves form part of the operating system, constantly feeding data back in.
</p>
<img src="/images/planet-earth.jpg" alt="Planet Earth"/>

<p>Douglas Adams&#8217; insight puts software development into perspective. True: we no longer print our product on silicon or ship it in boxes, and yes: we accept <a href="http://wordaligned.org/articles/why-software-development-isnt-like-construction">construction</a> is not the right metaphor, but: nor is production. <a href="http://swanseacon.co.uk/schedule/#session-27">Professor Dave Snowden</a> talks about entanglement &#8212; think of a system growing like brambles in a thicket. He emphasises what&#8217;s natural, evolutionary and human. Object oriented design lost out when it narrowed its focus. Remember, people are objects too. The world is our platform.
</p>

</div>


<div class="atomentry" id="swanseacon-2017">
<h2 class="title"><a href="/articles/swanseacon-2017">SwanseaCon 2017</a></h2>
<p class="meta"><abbr class="published" title="2017-09-26">2017-09-26</abbr> &bull; <a href="/tag/self" rel="tag">Self</a>, <a href="/tag/talks" rel="tag">Talks</a>, <a href="/tag/swansea" rel="tag">Swansea</a> &bull; <a href="/articles/swanseacon-2017#disqus_thread">Comments</a></p>
<div><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Unit tests, lets get sceptical <a href="https://twitter.com/thomasguest">@thomasguest</a> was a great end to the morning before lunch <a href="https://t.co/EM4RPAs975">pic.twitter.com/EM4RPAs975</a></p>&mdash; SwanseaCon (@SwanseaCon) <a href="https://twitter.com/SwanseaCon/status/912361247760404480">September 25, 2017</a></blockquote><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script></div>

<p>I&#8217;m just back from a packed two days at <a href="http://swanseacon.co.uk">SwanseaCon</a> and would like to thank the organisers, speakers and participants for making such a welcoming and diverse conference happen right where I live.
</p>
<p>For me, highlights included:
</p>
<ul>
 <li>
     Professor Dave Snowden&#8217;s erudite and slide-free talk. It was a privilege to listen: although I may not quite have kept up, I will certainly follow up
 </li>

 <li>
     Irina Tsyganok&#8217;s sensitive and inspirational presentation on pair-programming
 </li>

 <li>
     Lawrence Weetman&#8217;s dishwashing demo &#8212; with three on-stage helpers, no less
 </li>

 <li>
     Scott Fulton&#8217;s honest report on some personal agile life lessons
 </li>
</ul>
<p>The venue wasn&#8217;t too shabby either.
</p>
<p><a data-flickr-embed="true"  href="https://www.flickr.com/photos/thomasguest/37286571132/in/photostream/" title="The view from SwanseaCon"><img src="https://farm5.staticflickr.com/4462/37286571132_a5892fe22c_z.jpg" width="640" height="185" alt="The view from SwanseaCon"></a><script async src="//embedr.flickr.com/assets/client-code.js" charset="utf-8"></script>
</p>
<p>Having attended a fair few technical conferences, it felt refreshing and important to be part of something a little softer. Software development is about community, communication and culture, and SwanseaCon scored top marks on all three.
</p>
<p>So, again, thanks!
</p>

</div>


<div class="atomentry" id="pay-rise-please">
<h2 class="title"><a href="/articles/pay-rise-please">Pay rise please</a></h2>
<p class="meta"><abbr class="published" title="2017-07-25">2017-07-25</abbr> &bull; <a href="/tag/self" rel="tag">Self</a>, <a href="/tag/perec" rel="tag">Perec</a>, <a href="/tag/oulipo" rel="tag">Oulipo</a>, <a href="/tag/javascript" rel="tag">Javascript</a> &bull; <a href="/articles/pay-rise-please#disqus_thread">Comments</a></p>
<p>In 1967 Georges Perec wrote a radio play, L&#8217;Augmentation, in which you, the protagonist, make some delicate decisions whilst negotiating a pay rise. Is your boss, Mr X, in a good mood? Did he have fish for lunch? Does one of his daughters have measles?
</p>
<img src="/images/perec-flowchart.jpg" alt="Flowchart"/>

<p>The story takes the form of a <a href="https://en.wikipedia.org/wiki/Flowchart">flow chart</a>. It&#8217;s no coincidence it was written when computers were becoming a part of office and laboratory work, and when flow charts became a popular way to represent the algorithms they were programmed with. 1967 is also the year Perec joined Oulipo, a literary organisation whose members seek to create works based around mathematical constraints and structures. The loops and branches of Perec&#8217;s flow chart perfectly embody the frustrating routines of office politics.
</p>
<p>Fifty years on, I&#8217;ve <a href="https://github.com/wordaligned/pay-rise-please" title="Pay rise please, on Github">created a version</a> to run on Alexa, which you can <a href="https://www.amazon.co.uk/Mr-Pay-rise-please/dp/B07417SK8N" title="Pay rise please, on Amazon">download from Amazon</a>. It may not get me a pay rise, but I should qualify for a <a href="https://developer.amazon.com/alexa-skills-kit">freebie Echo Dot</a>.
</p>
<img src="/images/perec512.jpg" alt="Georges Perec"/>

</div>


<div class="atomentry" id="follow-me-follow-me">
<h2 class="title"><a href="/articles/follow-me-follow-me">Follow me follow me</a></h2>
<p class="meta"><abbr class="published" title="2017-07-04">2017-07-04</abbr> &bull; <a href="/tag/animation" rel="tag">Animation</a>, <a href="/tag/javascript" rel="tag">Javascript</a>, <a href="/tag/scrum" rel="tag">Scrum</a> &bull; <a href="/articles/follow-me-follow-me#disqus_thread">Comments</a></p>
<h2>Leap</h2>
<p>There were 12 of us in the room, plus Jim the instructor.
</p>
<p>We had moved the tables and chairs to one side. Jim asked us to stand in the space we&#8217;d created. He asked each of us to pick two other people in the room, without telling anyone who we&#8217;d chosen.
</p>
<p>The object of this exercise, Jim said, is to move around until each person is at an equal distance from the two people they&#8217;ve chosen.
</p>
<p>Jim appointed Jo project manager. 
</p>
<p>You&#8217;re the project manager, Jim said. Get your team organised.
</p>
<p>Jo had no particular instructions but as a team we instinctively started moving, stepping and turning. I was tracking Mark and Jo &#8212; who I&#8217;d chosen before her appointment as PM. I imagined a straight line on the floor of the room between the two of them and equidistant from both and walked towards it, adjusting my trajectory as they too moved. Ruth and Paul must have been following me: as I moved they turned and moved too.
</p>
<p>Quite quickly we slowed down, making fine adjustments, shuffling into a final position. Was everyone happy? Yes? We&#8217;d done it.
</p>
<p>Good work Jo!
</p>
<p>What had Jo done? She&#8217;d let us get on with it. We were a self-organising team. What had I done? I&#8217;d suppressed my mathematical instinct to think before moving &#8212; I&#8217;d leapt rather than looked.
</p>

<h2>Look</h2>
<p>This is a great team training exercise. It encourages exploration and trust. Evidently it works, too &#8212; however people choose who to follow, there will be a solution which can be discovered using a simple and sensible strategy. It made me think of shoal behaviour in animals, where there is no leader and each individual follows the same small set of rules, but the apparently sophisticated resulting behaviour suggests the shoal has a mind of its own.
</p>
<p><a href="/followme/" title="Click this snapshot to see the live page"><img src="/images/followme.png" alt="animation"></a>
</p>
<p>I experimented with a computer simulation. The picture above is a static snap shot &#8212; click it to access the <a href="/followme/">live page</a> and explore different configurations. I plan to experiment with different shoaling strategies and to expose more controls. The source code is here <a href="https://github.com/wordaligned/followme">github.com/wordaligned/followme</a>.
</p>

</div>


<div class="atomentry" id="unleash-the-test-army">
<h2 class="title"><a href="/articles/unleash-the-test-army">Unleash the test army</a></h2>
<p class="meta"><abbr class="published" title="2017-05-29">2017-05-29</abbr> &bull; <a href="/tag/tests" rel="tag">Tests</a>, <a href="/tag/python" rel="tag">Python</a> &bull; <a href="/articles/unleash-the-test-army#disqus_thread">Comments</a></p>
<h2>Are the tests adequate?</h2>
<p>Recently I described a solution to <a href="/articles/slicing-a-list-evenly-with-python">the problem of dividing a list into evenly sized chunks</a>. It&#8217;s a simple enough problem with just two inputs: the list (or other sliceable container) <code>xs</code> and the number of chunks <code>n</code>. Nonetheless, there are traps to avoid and special cases to consider &#8212; what if <code>n</code> is larger than the list, for example? Must the chunks comprise contiguous elements from the original list?
</p>
<p>The tests I came up with are straightforward and uninspiring. They were developed within the context of my own assumptions about the solution and the special cases I could imagine. They were written after the implementation &#8212; which is to say, development wasn&#8217;t driven by tests. They are whitebox tests, designed to cover the various paths through the code based on my insider knowledge.
</p>
<p>Are these tests adequate? Certainly they don&#8217;t accurately represent the data which will hit the algorithm in practice. Can we be sure we haven&#8217;t missed anything? Would the tests still cover all paths if the implementation changed?
</p>

<h2>Property based testing</h2>
<p>David R MacIver described another, complementary, approach at <a href="https://accu.org/index.php/conferences/accu_conference_2016/accu2016_sessions#The_Plural_of_Anecdote_is_not_Test_Suite">a talk I attended at ACCU 2016</a>. In the talk abstract he characterises the (class of) tests I&#8217;d written as <strong>anecdotal</strong> &#8212; &#8220;let me tell you about this time I called a function &#8230; and then it returned this .. and then it raised an exception &#8230; etc. etc.&#8221;
</p>
<p>How about if the test suite instead describes the <strong>properties</strong> required of the system under test, and then conjures up inputs designed to see if these properties hold under stress? So, rather than our test suite being a limited set of input/output pairs, it becomes an executable specification validated by a robot army.
</p>
<p><a data-flickr-embed="true"  href="https://www.flickr.com/photos/avatarr8/3819520612" title="China&#x27;s Robot Army"><img src="https://c1.staticflickr.com/3/2431/3819520612_4b32f2b423.jpg" width="500" height="334" alt="China&#x27;s Robot Army"></a><script async src="//embedr.flickr.com/assets/client-code.js" charset="utf-8"></script>
</p>
<div class="extended">
<p><a href="/articles/unleash-the-test-army#continue-reading">Continue reading...</a></p>
</div>

</div>


<div class="atomentry" id="lazy-sequences-working-hard">
<h2 class="title"><a href="/articles/lazy-sequences-working-hard">Lazy sequences working hard</a></h2>
<p class="meta"><abbr class="published" title="2017-05-16">2017-05-16</abbr> &bull; <a href="/tag/python" rel="tag">Python</a>, <a href="/tag/streams" rel="tag">Streams</a> &bull; <a href="/articles/lazy-sequences-working-hard#disqus_thread">Comments</a></p>
<p>I gave a talk <a href="http://www.pydiff.wales/events/2017-05-16.html">@PyDiff</a> this evening in the computer science department at Cardiff University.
</p>
<blockquote><p><h2>Lazy Sequences working hard</h2>
</p>
<p>Python has no problem handling large and even infinite streams of data. Just write lazy programs &#8212; code which defers data access until the last minute. This talk examines Python&#8217;s language and library support for such delaying tactics. There will be live coding, and we&#8217;ll draw parallels with similar features in other languages, in particular the Unix shell.
</p>
</blockquote><p>Being unsure where to pitch it, I started off easy and kept going until I&#8217;d lost everybody &#8212; including myself.
</p>
<p>The room was well set up with a good quality projector and whiteboard, along with a desk to sit down when I wanted to write and run code and plenty of space to move around in otherwise. I did feel a bit like a jack-in-the-box by the end.
</p>
<p><a data-flickr-embed="true"  href="https://www.flickr.com/photos/thomasguest/34663534326/in/dateposted-friend/" title="Me @PyDiff"><img src="https://c1.staticflickr.com/5/4164/34663534326_4bf8851eeb.jpg" width="500" height="375" alt="Me @PyDiff"></a><script async src="//embedr.flickr.com/assets/client-code.js" charset="utf-8"></script>
</p>
<p>I&#8217;d based the talk on a Jupyter notebook which I replayed with the ingenious <a href="https://github.com/damianavila/RISE">RISE reveal.js extension</a> written by Damian Avila. This worked well, since I got the pretty graphics along with the interactive coding. A static version of the slides is <a href="http://nbviewer.jupyter.org/url/wordaligned.org/docs/lazy-sequences.ipynb">available here</a>.
</p>
<p>Thanks to everyone who came. Sorry I had to rush off after. If anyone would <a href="http://swanseasdc.co.uk/">like to talk at Swansea</a>, please let me know: you&#8217;d be most welcome.
</p>

</div>


<div class="atomentry" id="slicing-a-list-evenly-with-python">
<h2 class="title"><a href="/articles/slicing-a-list-evenly-with-python">Slicing a list evenly with Python</a></h2>
<p class="meta"><abbr class="published" title="2017-05-14">2017-05-14</abbr> &bull; <a href="/tag/python" rel="tag">Python</a> &bull; <a href="/articles/slicing-a-list-evenly-with-python#disqus_thread">Comments</a></p>
<img src="/images/sliced-python.jpg" alt="Sliced Python"/>

<p>Here&#8217;s a problem I came up against recently.
</p>
<p>The task was to chop a list into exactly <code>n</code> evenly slized chunks. To give a little more context, let&#8217;s suppose we want to divide a list of jobs equally between <code>n</code> workers, where <code>n</code> might be the number of CPU cores available.
</p>
<p>We can build the result by repeatedly slicing the input:
</p>
<div class="typocode">

<pre class="prettyprint">def chunk(xs, n):
    '''Split the list, xs, into n chunks'''
    L = len(xs)
    assert 0 &lt; n &lt;= L
    s = L//n
    return [xs[p:p+s] for p in range(0, L, s)]

</pre>

</div>

<p>This looks promising
</p>
<div class="typocode">

<pre class="prettyprint">&gt;&gt;&gt; chunk('abcdefghi', 3)
['abc', 'def', 'ghi']

</pre>

</div>

<p>but if the size of the list is not an exact multiple of <code>n</code>, the result won&#8217;t contain <strong>exactly</strong> <code>n</code> chunks.
</p>
<div class="typocode">

<pre class="prettyprint">&gt;&gt;&gt; chunk('abcde', 3)
['a', 'b', 'c', 'd', 'e']
&gt;&gt;&gt; chunk('abcdefgh', 3)
['ab', 'cd', 'ef', 'gh']
&gt;&gt;&gt; chunk('abcdefghij', 3)
['abc', 'def', 'ghi', 'j']

</pre>

</div>

<p>(By the way, I&#8217;m using strings rather than lists in the examples. The code works equally well for both types, and strings make it slightly easier to see what&#8217;s going on.)
</p>
<p>One way to fix the problem is to group the final chunks together.
</p>
<div class="typocode">

<pre class="prettyprint">def chunk(xs, n):
    '''Split the list, xs, into n chunks'''
    L = len(xs)
    assert 0 &lt; n &lt;= L
    s, r = divmod(L, n)
    chunks = [xs[p:p+s] for p in range(0, L, s)]
    chunks[n-1:] = [xs[-r-s:]]
    return chunks

</pre>

</div>

<p>Now we have exactly <code>n</code> chunks, but they may not be evenly sized, since the last chunk gets padded with any surplus.
</p>
<div class="typocode">

<pre class="prettyprint">&gt;&gt;&gt; chunk('abcde', 3)
['a', 'b', 'cde']
&gt;&gt;&gt; chunk('abcdefgh', 3)
['ab', 'cd', 'efgh']
&gt;&gt;&gt; chunk('abcdefghij', 3)
['abc', 'def', 'ghij']

</pre>

</div>

<p>What does &#8220;evenly sized&#8221; actually mean? Loosely speaking, we want the resulting chunks as closely sized as possible.
</p>
<p>More precisely, if the result of dividing the length of the list <code>L</code> by the number of chunks <code>n</code> gives a size <code>s</code> with remainder <code>r</code>, then the function should return <code>r</code> chunks of size <code>s+1</code> and <code>n-r</code> chunks of size <code>s</code>. There are <a href="https://en.wikipedia.org/wiki/Combination">choose(n, r)</a> ways of doing this. Here&#8217;s a solution which puts the longer chunks to the front of the results.
</p>
<div class="typocode">

<pre class="prettyprint">def chunk(xs, n):
    '''Split the list, xs, into n evenly sized chunks'''
    L = len(xs)
    assert 0 &lt; n &lt;= L
    s, r = divmod(L, n)
    t = s + 1
    return ([xs[p:p+t] for p in range(0, r*t, t)] +
            [xs[p:p+s] for p in range(r*t, L, s)])

</pre>

</div>

<p>Here&#8217;s a second implementation, this time using <code>itertools</code>. Chaining <code>r</code> copies of <code>s+1</code> and <code>n-r</code> copies of <code>s</code> gives us the <code>n</code> chunk widths. Accumulating the widths gives us the list offsets for slicing &#8212; though note we need to prepend an initial <code>0</code>. Now we can form a <a href="/articles/zippy-triples-served-with-python">(this, next) pair of iterators</a> over the offsets, and the result is the accumulation of repeated <code>(begin, end)</code> slices taken from the original list.
</p>
<div class="typocode">

<pre class="prettyprint">from itertools import accumulate, chain, repeat, tee

def chunk(xs, n):
    assert n &gt; 0
    L = len(xs)
    s, r = divmod(L, n)
    widths = chain(repeat(s+1, r), repeat(s, n-r))
    offsets = accumulate(chain((0,), widths))
    b, e = tee(offsets)
    next(e)
    return [xs[s] for s in map(slice, b, e)]

</pre>

</div>

<p>This version does something sensible in the case when the number of slices, <code>n</code>, exceeds the length of the list.
</p>
<div class="typocode">

<pre class="prettyprint">&gt;&gt;&gt; chunk('ab', 5)
['a', 'b', '', '', '']

</pre>

</div>

<p>Finally, some tests.
</p>
<div class="typocode">

<pre class="prettyprint">def test_chunk():
    assert chunk('', 1) == ['']
    assert chunk('ab', 2) == ['a', 'b']
    assert chunk('abc', 2) == ['ab', 'c']
    
    xs = list(range(8))
    assert chunk(xs, 2) == [[0, 1, 2, 3], [4, 5, 6, 7]]
    assert chunk(xs, 3) == [[0, 1, 2], [3, 4, 5], [6, 7]]
    assert chunk(xs, 5) == [[0, 1], [2, 3], [4, 5], [6], [7]]
    
    rs = range(1000000)
    assert chunk(rs, 2) == [range(500000), range(500000, 1000000)]

</pre>

</div>

</div>


<div class="atomentry" id="agile-at-a-distance">
<h2 class="title"><a href="/articles/agile-at-a-distance">Agile at a distance &#x1f44d;</a></h2>
<p class="meta"><abbr class="published" title="2017-04-14">2017-04-14</abbr> &bull; <a href="/tag/self" rel="tag">Self</a>, <a href="/tag/agile" rel="tag">Agile</a> &bull; <a href="/articles/agile-at-a-distance#disqus_thread">Comments</a></p>
<img width="540px" src="/docs/agile-at-a-distance/we-are-here.jpg" alt="We are here"/>

<p>I&#8217;m happy to be <a href="http://charlestolman.com/">part of a team</a> which supports remote working. This post collects a few notes on how agile practices fare when people may not be colocated. I don&#8217;t claim what&#8217;s written to be generally true; rather, it&#8217;s specific to me, my team, and how we work.
</p>
<img width="540px" src="/docs/agile-at-a-distance/remote-team.jpg" alt="Remote team"/>

<p>We&#8217;re by no means entirely distributed. There are seven of us in the engineering team, all UK based. We have a dedicated office space and of the seven, four are office-based and three are remote workers. Office-based staff are free to work from home when it suits. I&#8217;m office-based but work from home around 40% of the time, for example. Remote workers typically visit the office every couple of weeks to attend the sprint ceremonies &#8212; review, retrospective, planning. The rest of the company is more distributed and mobile, comprising product and marketing, medical experts, operations engineers, sales and admin.
</p>
<img width="540px" src="/docs/agile-at-a-distance/wfh.jpg" alt="WFH"/>
<div class="extended">
<p><a href="/articles/agile-at-a-distance#continue-reading">Continue reading...</a></p>
</div>

</div>


<div class="atomentry" id="from-bytes-to-strings-in-python-and-back-again">
<h2 class="title"><a href="/articles/from-bytes-to-strings-in-python-and-back-again">From bytes to strings in Python and back again</a></h2>
<p class="meta"><abbr class="published" title="2017-03-24">2017-03-24</abbr> &bull; <a href="/tag/python" rel="tag">Python</a>, <a href="/tag/unicode" rel="tag">Unicode</a> &bull; <a href="/articles/from-bytes-to-strings-in-python-and-back-again#disqus_thread">Comments</a></p>
<p>Low level languages like C have little opinion about what goes in a string, which is simply a null-terminated sequence of bytes. Those bytes could be ASCII or UTF-8 encoded text, or they could be raw data &#8212; object code, for example. It&#8217;s quite possible and legal to have a C string with mixed content.
</p>
<pre><code>char const * mixed =
    "EURO SIGN "          // ASCII
    "UTF-8 \xE2\x82\xAC " // UTF-8 encoded EURO SIGN
    "Latin-9 \xA4";       // Latin-9 encoded EURO SIGN
</code></pre><p>This might seem indisciplined and risky but it can be useful. Environment variables are notionally text but actually C strings, for example, meaning they can hold whatever data you want. Similarly filenames and command line parameters are only loosely text.
</p>
<p>A higher level language like Python makes a strict distinction between bytes and strings. Bytes objects contain raw data &#8212; a sequence of octets &#8212; whereas strings are Unicode sequences. Conversion between the two types is explicit: you encode a string to get bytes, specifying an encoding (which defaults to UTF-8); and you decode bytes to get a string. Clients of these functions should be aware that such conversions may fail, and should consider how failures are handled.
</p>
<p>Simply put, a string in Python is a valid Unicode sequence. Real world text data may not be. Programmers need to take charge of reconciling any discrepancies.
</p>
<p>We faced such problems recently <a href="https://clinithink.com">at work</a>. We&#8217;re in the business of extracting meaning from clinical narratives &#8212; text data stored on medical records systems in hospitals, for example. These documents may well have passed through a variety of systems. They may be unclear about their text encoding. They may not be encoded as they claim. So what? They can and do contain abbreviations, mispellings, jargon and colloquialisms. Refining the signal from such noise is our core business: if we can correctly interpret positional and temporal aspects of a sentence such as:
</p>
<blockquote><p>Previous fracture of left neck of femur
</p>
</blockquote><p>then we can surely deal with text which claims to be UTF-8 encoded but isn&#8217;t really.
</p>
<p>Our application stack is server-based: a REST API to a Python application handles document ingest; lower down, a C++ engine does the actual document processing. The problem we faced was supporting a modern API capable of handling real world data.
</p>
<p>It&#8217;s both undesirable and unnecessary to require clients to clean their text before submitting it. We want to make the ingest direct and idiomatic. Also, we shouldn&#8217;t penalise clients whose data <strong>is</strong> clean. Thus document upload is an HTTP POST request, and the document content is a JSON string &#8212; rather than, say, base64 encoded binary data. Our server, however, will be permissive about the contents of this string.
</p>
<p>So far so good. <a href="http://www.catb.org/jargon/html/P/Postels-Prescription.html" title="Postel's prescription">Postel&#8217;s prescription</a> advises:
</p>
<blockquote><p>Be liberal in what you accept, and conservative in what you send.
</p>
</blockquote><p>This would suggest accepting messy text data but presenting it in a cleaned up form. In our case, we <strong>do</strong> normalise the input data &#8212; a process which includes detecting and standardising date/time information, expanding abbreviations, fixing typos and so on &#8212; but this normalised form links back to a faithful copy of the original data. What gets presented to the user is their own text annotated with our findings. That is, we subscribe to a <a href="https://en.wikipedia.org/wiki/Garbage_in,_garbage_out">more primitive prescription</a> than Postel&#8217;s:
</p>
<blockquote><p>Garbage in, garbage out
</p>
</blockquote><p>with the caveat that the garbage shouldn&#8217;t be damaged in transit.
</p>
<p>Happily, there is a simple way to pass dodgy strings through Python. It&#8217;s used in the standard library to handle text data which isn&#8217;t guaranteed to be clean &#8212; those environment variables, command line parameters, and filenames for example.
</p>
<p>The <code>surrogateescape</code> error handler smuggles non-decodable bytes into the (Unicode) Python string in such a way that the original bytes can be recovered on encode, as described in <a href="https://www.python.org/dev/peps/pep-0383/" title="PEP 383 -- Non-decodable Bytes in System Character Interfaces">PEP 383</a>:
</p>
<blockquote><p>On POSIX systems, Python currently applies the locale&#8217;s encoding to convert the byte data to Unicode, failing for characters that cannot be decoded. With <a href="https://www.python.org/dev/peps/pep-0383/" title="PEP 383 -- Non-decodable Bytes in System Character Interfaces">this PEP</a>, non-decodable bytes &gt;= 128 will be represented as lone surrogate codes U+DC80..U+DCFF.
</p>
</blockquote><p>This workaround is possible because Unicode surrogates are intended for use in pairs. Quoting the Unicode specification, they <a href="http://www.unicode.org/versions/Unicode9.0.0/ch03.pdf#G2630">&#8220;have no interpretation on their own&#8221;</a>. The lone trailing surrogate code &#8212; the half-a-pair &#8212; can only be the result of a <code>surrogateescape</code> error handler being invoked, and the original bytes can be recovered by using the same error handler on encode.
</p>
<p>In conclusion, text data is handled differently in C++ and Python, posing a problem for layered applications. The <code>surrogateescape</code> error handler provides a standard and robust way of closing the gap.
</p>

<h2>Unicode Surrogate Pairs</h2>
<p><a href="http://www.unicode.org/versions/Unicode9.0.0/ch03.pdf#G2630"><img src="/images/unicode-surrogates.png" alt="Surrogates"/></a>
</p>

<h2>Code Listing</h2>
<pre><code>&gt;&gt;&gt; mixed = b"EURO SIGN \xE2\x82\xAC \xA4"
&gt;&gt;&gt; mixed
b'EURO SIGN \xe2\x82\xac \xa4'
&gt;&gt;&gt; mixed.decode()
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 14:
  invalid start byte
&gt;&gt;&gt; help(mixed.decode)
Help on built-in function decode:

decode(encoding='utf-8', errors='strict') method of builtins.bytes instance
    Decode the bytes using the codec registered for encoding.

encoding
      The encoding with which to decode the bytes.
    errors
      The error handling scheme to use for the handling of decoding errors.
      The default is 'strict' meaning that decoding errors raise a
      UnicodeDecodeError. Other possible values are 'ignore' and 'replace'
      as well as any other name registered with codecs.register_error that
      can handle UnicodeDecodeErrors.

&gt;&gt;&gt; mixed.decode(errors='surrogateescape')
'EURO SIGN &euro; \udca4'
&gt;&gt;&gt; s = mixed.decode(errors='surrogateescape')
&gt;&gt;&gt; s.encode()
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
UnicodeEncodeError: 'utf-8' codec can't encode character '\udca4' in position 12:
  surrogates not allowed
&gt;&gt;&gt; s.encode(errors='surrogateescape')
b'EURO SIGN \xe2\x82\xac \xa4'
</code></pre>

</div>


<div class="atomentry" id="24-puzzles">
<h2 class="title"><a href="/articles/24-puzzles">24 Puzzles</a></h2>
<p class="meta"><abbr class="published" title="2017-03-08">2017-03-08</abbr> &bull; <a href="/tag/puzzles" rel="tag">Puzzles</a>, <a href="/tag/python" rel="tag">Python</a> &bull; <a href="/articles/24-puzzles#disqus_thread">Comments</a></p>
<p>On <a href="http://blog.plover.com">The Universe of Discourse</a> Mark Dominus discusses the classic <a href="http://blog.plover.com/math/24-puzzle.html">24 Puzzle</a>:
</p>
<blockquote><p>You are given a sequence of four digits, say 1, 2, 3, 4, and your job is to combine them with ordinary arithmetic operations (+, -, &times;, and &divide;) in any order to make a target number, typically 24. For example, with 1, 2, 3, 4, you can go with <code>((1+2)+3)&times;4=24</code> or with <code>4&times;((2&times;3)&times;1)=24</code>.
</p>
</blockquote><p>Here&#8217;s a solver for such puzzles. It uses <code>itertools</code> to generate possible expressions, <code>fractions</code> to get the arithmetic right, and <code>eval</code> to evaluate expressions. It&#8217;s limited to expressions formed from 4 numbers which means I don&#8217;t have to programmatically calculate different ways of parenthesising: there are only 5.
</p>
<div class="typocode">

<pre class="prettyprint"># http://blog.plover.com/math/24-puzzle.html
import re
import math

# Use fractions for exact calculations
from fractions import Fraction

# Solve for 4 numbers only!
N = 4

# So these are the only expression templates
# where X is a number and @ is an operation
templates = '''\
((X @ X) @ X) @ X
(X @ (X @ X)) @ X
X @ ((X @ X) @ X)
X @ (X @ (X @ X))
(X @ X) @ (X @ X)'''.splitlines()

import itertools as its

def defrac(s):
    return re.compile(r'Fraction\((\d+)\)').sub(r'\1', s)

def evaluate(nums, ops, template):
    fracs = ('Fraction(%s)' % n for n in nums)
    ops = iter(ops)
    expr = ''.join(next(fracs) if c == 'X' else
                   next(ops) if c == '@' else c
                   for c in template)
    try:
        return expr, eval(expr)
    except ZeroDivisionError:
        return expr, None

def solve(spec, ops):
    numbers = re.compile(r'\d+').findall(spec)
    assert len(numbers) == N + 1
    result = Fraction(numbers.pop())
    seqs = its.product(its.permutations(numbers),
                       its.product(ops, repeat=N-1),
                       templates)
    print(defrac(next((e for e, v in its.starmap(evaluate, seqs)
                       if v == result),
                      'Impossible')))

def main():
    solve('2,5,6,6 =&gt; 17', '+-/*')
    solve('3,3,8,8 =&gt; 24', '+-/*')

main()

</pre>

</div>

<p>Here&#8217;s a second attempt, which doesn&#8217;t assume there will just be 4 numbers on the left hand side of the equation. Given a sequence of numbers and a set of operators, it repeatedly reduces the sequence length by picking pair of numbers and combining them using one of the operators, iterating over all possible ways of doing this. The first sequence of length 1 which equals the target value gives a solution and terminates the search.
</p>
<div class="typocode">

<pre class="prettyprint"># http://blog.plover.com/math/24-puzzle.html
from fractions import Fraction
import itertools as its
import operator
import re

def pick2(xs):
    return ((p[:2], p[2:]) for p in its.permutations(xs))

def allow(op, l, r):
    return op != '/' or eval(r) != 0

def apply(op, l, r):
    return '(%s%s%s)'%(l, op, r)

def values(xs, ops):
    L = [xs]
    while L:
        xs = L.pop()
        if len(xs) == 1:
            yield xs.pop()
        else:
            L.extend([apply(op, *lr)] + list(tl)
                     for op, (lr, tl) in its.product(ops, pick2(xs))
                     if allow(op, *lr))

def solve(spec, ops):
    numbers = ['Fraction(%s)'%n for n in re.compile(r'\d+').findall(spec)]
    target = eval(numbers.pop())
    print(next((v for v in values(numbers, ops) if eval(v) == target), 'Impossible'))

def main():
    solve('2,5,6,6 =&gt; 17', '+-/*')
    solve('3,3,8,8 =&gt; 24', '+-/*')

main()

</pre>

</div>

</div>


<div class="atomentry" id="unit-tests-questioned-reading-list">
<h2 class="title"><a href="/articles/unit-tests-questioned-reading-list">Unit Tests Questioned: Reading List</a></h2>
<p class="meta"><abbr class="published" title="2017-02-01">2017-02-01</abbr> &bull; <a href="/tag/self" rel="tag">Self</a>, <a href="/tag/tests" rel="tag">Tests</a>, <a href="/tag/knuth" rel="tag">Knuth</a>, <a href="/tag/hoare" rel="tag">Hoare</a> &bull; <a href="/articles/unit-tests-questioned-reading-list#disqus_thread">Comments</a></p>
<p>I enjoyed <a href="http://swanseasdc.co.uk/events/why-service-oriented-architecture/">talking about unit testing</a> last night, and would like to thank <a href="https://twitter.com/SwanseaSDC">Swansea Software Development Community</a> and especially Viv Richards for organising the event, <a href="https://swansea.techhub.com/">TechHub</a> for the venue, and everyone who turned up to listen, ask questions and offer feedback.
</p>
<div><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Up first <a href="https://twitter.com/thomasguest">@thomasguest</a> <a href="https://twitter.com/hashtag/ssdc?src=hash">#ssdc</a> <a href="https://t.co/4nEqh0ErZr">pic.twitter.com/4nEqh0ErZr</a></p>&mdash; SSDC (@SwanseaSDC) <a href="https://twitter.com/SwanseaSDC/status/826137883341885441">January 30, 2017</a></blockquote><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script></div>

<p>The slides are available <a href="/docs/unit-tests">here</a>. You&#8217;ll find links in the slide deck to the various papers and articles I referenced, but for convenience I&#8217;m listing them here with some notes.
</p>
<ol>
 <li><p><big><a href="http://www.gwern.net/docs/1996-hoare.pdf" title="Tony Hoare, How Did Software Get So Reliable Without Proof? (PDF)">How Did Software Get So Reliable Without Proof?</a></big> by Sir Tony Hoare, published in 1996, is a considered and authoritative paper, in which the author calls into question much of his own research. It&#8217;s not necessary to prove your programs correct, he writes, you can create systems which are both large and reliable using more pragmatic techniques. Since then, his conviction has strengthened. I had the privilege of attending his keynote at <a href="/articles/europython-2009">Europython 2009</a>, when he spoke about the science of computing and the engineering of software (this same talk is available on <a href="https://www.infoq.com/presentations/tony-hoare-computing-engineering">InfoQ</a>). His closing slide stated: One day, software will be the most reliable component of every product which contains it; and software engineering will be the most dependable of all engineering professions.
</p>

 </li>

 <li><p><big><a href="http://rbcs-us.com/documents/Why-Most-Unit-Testing-is-Waste.pdf" title="Why Most Unit Testing is Waste (PDF)">Why Most Unit Testing is Waste</a></big> by James O Coplien calls out the unit testing zealots and makes the point that testers should be skeptical.
</p>

 </li>

 <li><p><big><a href="http://www.sqlite.org/testing.html" title="How SQLite Is Tested">How SQLite Is Tested</a></big> details what it takes to make bomb-proof software. Most of the tests described are system level tests. It&#8217;s an impressive document which proves that writing tests requires creativity, determination and maybe even a sprinkling of malice.
</p>

 </li>

 <li><p><big><a href="https://testing.googleblog.com/2016/05/flaky-tests-at-google-and-how-we.html" title="Flaky Tests at Google and How We Mitigate Them, John Micco">Flaky Tests at Google and How We Mitigate Them</a></big> is an honest and all too familiar tale of unreliable tests. However hard you try to eradicate test instabilities, it seems they creep back in at the same rate.
</p>

 </li>

 <li><p><big><a href="https://martinfowler.com/articles/testing-culture.html" title="Goto Fail, Heartbleed, and Unit Testing Culture">Goto Fail, Heartbleed, and Unit Testing Culture</a></big> argues unit tests would have trapped some notorious bugs in low level security software. It goes on to describe in detail the changing culture of the Google Web Server team, which successfully adopted a test-focused regime. There&#8217;s some good advice on de-flaking, so I hope the author connected with his suffering colleagues.
</p>

 </li>

 <li><p><big><a href="https://staff.fnwi.uva.nl/p.vanemdeboas/knuthnote.pdf" title="The correspondence between Donald E. Knuth and Peter van Emde Boas on priority deques during the spring of 1977">The correspondence between Donald E. Knuth and Peter van Emde Boas on priority deques during the spring of 1977</a></big> provides the background and context of Donald Knuth&#8217;s famous quotation, &#8220;Beware of bugs in the above code; I have only proved it correct, not tried it&#8221;. It&#8217;s a a witty admonition but Donald Knuth isn&#8217;t joking. Don&#8217;t trust code until you&#8217;ve run it. Better, run it repeatedly through automated tests.
</p>

 </li>
</ol>

</div>


<div class="atomentry" id="unit-tests-questioned">
<h2 class="title"><a href="/articles/unit-tests-questioned">Unit Tests Questioned</a></h2>
<p class="meta"><abbr class="published" title="2017-01-21">2017-01-21</abbr> &bull; <a href="/tag/self" rel="tag">Self</a>, <a href="/tag/tests" rel="tag">Tests</a>, <a href="/tag/talks" rel="tag">Talks</a> &bull; <a href="/articles/unit-tests-questioned#disqus_thread">Comments</a></p>
<p>I&#8217;m looking forward to <a href="http://swanseasdc.co.uk/events/why-service-oriented-architecture/">talking at TechHub Swansea</a> at the end of the month on the subject of unit testing. 
</p>
<p>The introduction to the talk is here. 
</p>
<p>Hope to see you there.
</p>
<p><a href="/docs/unit-tests/"><img width=640 src="/images/unit-tests-questioned.png" alt="Unit Tests Questioned"/></a>
</p>
<p>In this talk we&#8217;ll consider if unit testing is a good use of our time.
</p>
<p>I am not questioning whether <strong>testing</strong> is important. This slide shows the abstract of <a href="http://www.gwern.net/docs/1996-hoare.pdf" title="(PDF) How did software get so reliable without proof?">a paper published in 1996 by Tony Hoare</a>. What he says is that you don&#8217;t need to <strong>prove</strong> your software works: you can make it so through design and review; by testing; and by good engineering.
</p>
<img width=640 src="/docs/unit-tests/images/how-did-software-get-so-reliable.png" alt="How did software get so reliable without proof?"/>

<p>This may no longer seem controversial or novel but maybe it was a surprising thing for Tony Hoare to say. After all, he invented <a href="https://en.wikipedia.org/wiki/Quicksort">quicksort</a> back in 1959, an algorithm which he <strong>proved</strong> correct. He also proved how quickly it runs, and that &#8212; in the general case &#8212; it couldn&#8217;t be beaten. Much of Hoare&#8217;s subsequent research was dedicated to proving software works using techniques known as <a href="https://en.wikipedia.org/wiki/Formal_methods" title="Formal Methods (Wikipedia)">formal methods</a>. The idea is that you write a formal specification of what your program should do, and then you mathematically verify your code satisfies that specification. Surely nothing less is good enough for software which really is a matter of life and death: a life support system, or a device driver in a nuclear warhead, for example? Actually, no, he says in this paper, there are more pragmatic routes to reliable software.
</p>
<p>So, the idea that you can build reliability via testing may once have seemed radical. It doesn&#8217;t any more. Maybe, though, the conventional modern wisdom that <strong>unit tests</strong> are a good thing should be questioned.
</p>
<img src="/docs/unit-tests/images/coplien.jpg" alt="Coplien" />

<p>James O Coplien voices a dissenting opinion in a more recent paper, <a href="http://rbcs-us.com/documents/Why-Most-Unit-Testing-is-Waste.pdf" title="(PDF) Why Most Unit Testing is Waste">&#8220;Why most unit testing is waste&#8221;</a>.
</p>
<p>What&#8217;s Cope on about!?
</p>
<p>Such is the force of current thinking that even the title of this paper makes it seem like he&#8217;s trolling. Having read the paper carefully, I don&#8217;t think he is. That doesn&#8217;t mean I agree with him, but I agree with his attitude:
</p>
<blockquote><p>There&#8217;s a lot of advice, but very little of it is backed either by theory, data, or even a model of why you should believe a given piece of advice. Good testing begs skepticism. Be skeptical of yourself: measure, prove, retry. Be skeptical of me for heaven&#8217;s sake.
</p>
</blockquote><p>So, this talk will do just that.
</p>
<p>Unit tests: let&#8217;s get skeptical!
</p>

</div>


<div class="atomentry" id="a-language-people-use-and-bitch-about">
<h2 class="title"><a href="/articles/a-language-people-use-and-bitch-about">A language people use and bitch about</a></h2>
<p class="meta"><abbr class="published" title="2016-08-24">2016-08-24</abbr> &bull; <a href="/tag/c" rel="tag">C</a>, <a href="/tag/c++" rel="tag">C++</a> &bull; <a href="/articles/a-language-people-use-and-bitch-about#disqus_thread">Comments</a></p>
<p>Every so often a new essay hits the top of the programming news sites:
</p>
<ul>
 <li>
     why I&#8217;m rewriting <a href="http://250bpm.com/blog:4" title="Why should I have written ZeroMQ in C, not C++">X in C</a> (and abandoning C++)
 </li>

 <li>
     why we will never use C++ for Y (which has always been written in C)
 </li>

 <li>
     why C++ is a <a href="http://thread.gmane.org/gmane.comp.version-control.git/57643/focus=57918" title="Torvalds rants about C++">horrible language</a> (it isn&#8217;t C)
 </li>
</ul>
<p>I&#8217;m a sucker for these articles and have some sympathy with them. Every so often I work with C code rather than C++, and find the experience refreshing: rapid compilation, clear build diagnostics, comprehensible APIs, easy debugging, and an agreeable reduction in layering and punctuation.
</p>
<p>It&#8217;s always easy to return to C because it hasn&#8217;t really changed. Well, it <strong>has</strong> changed, conservatively, and C programmers seem conservative in adopting new features.
</p>
<p>By contrast, C++ <strong>does</strong> change. Sure, C++0X was a long time coming &#8212; finally realised as C++11 &#8212; but since that giant step, smaller improvements continue apace. As a result C++ code soon looks stale. Every time I visit a source file it seems I have to freshen it, using the new way to prevent copying, or return containers, or manage resources, or pass functions, or &#8230; you get the idea.
</p>
<p>The truth is, every substantial C++ codebase I&#8217;ve worked on reads like a history of C++. Somewhere low down there&#8217;ll be hand-written intrusive linked lists; then there&#8217;ll be a few layers of classes, some nested for good measure; then templates, <a href="http://www.boost.org/">boost</a>, functions disguised as classes for use in algorithms; and finally the good stuff, in which auto, lambda, move semantics and intialisers allow us to code as we&#8217;ve always wanted.
</p>
<p>Bjarne Stroustrup <a href="http://www.stroustrup.com/blast.html">defends C++ on his website</a>:
</p>
<blockquote><p>As someone remarked: There are only two kinds of programming languages: those people always bitch about and those nobody uses.
</p>
</blockquote><p>If that &#8220;someone&#8221; wasn&#8217;t Stroustrup, it is now &#8212; he has become the source of his own quotation. His point is that C++ is well-used and must therefore be bitched about.
</p>
<p>C provides an immediate counter-example, however. It is undeniably used, but its <a href="https://en.wikipedia.org/wiki/C_Traps_and_Pitfalls">traps and pitfalls</a> are known and respected, rather than bitched about.
</p>
<p>Ultimately, though, I find C too limited. The lack of standard containers and algorithms combined with the overheads of heap management and ubiquitous error checking make programming in C heavy going.
</p>
<p>C++ is hard to learn and hard to keep up with. The language has grown, considerably, but the progression is necessary. It&#8217;s the more recent extensions which fully realise the power of the standard template library, for example. Stick with C++. The reward will be code which is expressive and efficient.
</p>

</div>


<div class="extended">
<p><a href="/articles/">Visit the Word Aligned archives...</a></p>
</div>

      
<div id="comments"><script type="text/javascript">
//<![CDATA[
(function() {
    var links = document.getElementsByTagName('a');
    var query = '?';
    for(var i = 0; i < links.length; i++) {
        if(links[i].href.indexOf('#disqus_thread') >= 0) {
            query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&amp;';
        }
    }
    document.write('<script type="text/javascript" src="http://disqus.com/forums/wordaligned/get_num_replies.js' + query + '"></' + 'script>');
})();
//]]>
</script></div>

    </div>
    <div id="sidebar">
      <div class="sidebar-node">
<h3>Hello, World!</h3>
<p>Welcome to <a href="/">Word Aligned</a>, a collection of articles on software development and computer programming.</p>
<p>I&#8217;m <a href="http://tag.wordaligned.org">Thomas Guest</a>, an experienced and enthusiastic computer programmer who prefers <a href="/articles/pitching-python-in-three-syllables.html">high-level languages</a> and <a href="/articles/fixed-wheels-and-simple-designs.html">simple solutions</a>. My writing has been published in a number of online and print magazines as well as here at <a href="/">wordaligned.org</a>.</p>


</div>

<div class="sidebar-node">
<h3>Feeds</h3>

<ul>
<li><a href="http://feeds.wordaligned.org/wordaligned"><img src="/images/buttons/feed-icon-14x14.png" alt="feed icon"/> Articles</a></li>
<li><a href="http://feeds.wordaligned.org/wordaligned/comments"><img src="/images/buttons/feed-icon-14x14.png" alt="feed icon"/> Comments</a></li>
</ul>


</div>

<div class="sidebar-node">
<h3>Top Tags</h3>
<ul id="categories"><li><a href="/tag/python" rel="tag">Python</a> <em>(122)</em></li>
<li><a href="/tag/c++" rel="tag">C++</a> <em>(71)</em></li>
<li><a href="/tag/self" rel="tag">Self</a> <em>(66)</em></li>
<li><a href="/tag/puzzles" rel="tag">Puzzles</a> <em>(36)</em></li>
<li><a href="/tag/accu" rel="tag">ACCU</a> <em>(33)</em></li>
<li><a href="/tag/web-applications" rel="tag">Web Applications</a> <em>(27)</em></li>
<li><a href="/tag/subversion" rel="tag">Subversion</a> <em>(27)</em></li>
<li><a href="/tag/algorithms" rel="tag">Algorithms</a> <em>(25)</em></li>
<li><a href="/tag/google" rel="tag">Google</a> <em>(19)</em></li>
<li><a href="/tag/characters" rel="tag">Characters</a> <em>(17)</em></li></ul>

</div>

<div class="sidebar-node">
<h3>All Tags</h3>
<p><a href="/tag/accidents" rel="tag">accidents</a>, <a href="/tag/accu" rel="tag">accu</a>, <a href="/tag/agile" rel="tag">agile</a>, <a href="/tag/algorithms" rel="tag">algorithms</a>, <a href="/tag/android" rel="tag">android</a>, <a href="/tag/animation" rel="tag">animation</a>, <a href="/tag/apple" rel="tag">apple</a>, <a href="/tag/arc" rel="tag">arc</a>, <a href="/tag/awk" rel="tag">awk</a>, <a href="/tag/books" rel="tag">books</a>, <a href="/tag/boost" rel="tag">boost</a>, <a href="/tag/bristol" rel="tag">bristol</a>, <a href="/tag/bugs" rel="tag">bugs</a>, <a href="/tag/build" rel="tag">build</a>, <a href="/tag/c" rel="tag">c</a>, <a href="/tag/c++" rel="tag">c++</a>, <a href="/tag/characters" rel="tag">characters</a>, <a href="/tag/charts" rel="tag">charts</a>, <a href="/tag/chess" rel="tag">chess</a>, <a href="/tag/clrs" rel="tag">clrs</a>, <a href="/tag/conferences" rel="tag">conferences</a>, <a href="/tag/content" rel="tag">content</a>, <a href="/tag/crabs" rel="tag">crabs</a>, <a href="/tag/curl" rel="tag">curl</a>, <a href="/tag/cvs" rel="tag">cvs</a>, <a href="/tag/cvs2svn" rel="tag">cvs2svn</a>, <a href="/tag/cycling" rel="tag">cycling</a>, <a href="/tag/decorators" rel="tag">decorators</a>, <a href="/tag/design" rel="tag">design</a>, <a href="/tag/disqus" rel="tag">disqus</a>, <a href="/tag/docbook" rel="tag">docbook</a>, <a href="/tag/documentation" rel="tag">documentation</a>, <a href="/tag/drawing" rel="tag">drawing</a>, <a href="/tag/dynamic-languages" rel="tag">dynamic-languages</a>, <a href="/tag/editors" rel="tag">editors</a>, <a href="/tag/emacs" rel="tag">emacs</a>, <a href="/tag/erlang" rel="tag">erlang</a>, <a href="/tag/esr" rel="tag">esr</a>, <a href="/tag/etc" rel="tag">etc</a>, <a href="/tag/europython" rel="tag">europython</a>, <a href="/tag/fractals" rel="tag">fractals</a>, <a href="/tag/functional-programming" rel="tag">functional-programming</a>, <a href="/tag/github" rel="tag">github</a>, <a href="/tag/go" rel="tag">go</a>, <a href="/tag/google" rel="tag">google</a>, <a href="/tag/graphics" rel="tag">graphics</a>, <a href="/tag/haskell" rel="tag">haskell</a>, <a href="/tag/hoare" rel="tag">hoare</a>, <a href="/tag/ide" rel="tag">ide</a>, <a href="/tag/imagemagick" rel="tag">imagemagick</a>, <a href="/tag/iphone" rel="tag">iphone</a>, <a href="/tag/java" rel="tag">java</a>, <a href="/tag/javascript" rel="tag">javascript</a>, <a href="/tag/knuth" rel="tag">knuth</a>, <a href="/tag/lcs" rel="tag">lcs</a>, <a href="/tag/lighttpd" rel="tag">lighttpd</a>, <a href="/tag/lisp" rel="tag">lisp</a>, <a href="/tag/markdown" rel="tag">markdown</a>, <a href="/tag/missiles" rel="tag">missiles</a>, <a href="/tag/ocr" rel="tag">ocr</a>, <a href="/tag/openid" rel="tag">openid</a>, <a href="/tag/oulipo" rel="tag">oulipo</a>, <a href="/tag/perec" rel="tag">perec</a>, <a href="/tag/perl" rel="tag">perl</a>, <a href="/tag/php" rel="tag">php</a>, <a href="/tag/pi" rel="tag">pi</a>, <a href="/tag/pictures" rel="tag">pictures</a>, <a href="/tag/pil" rel="tag">pil</a>, <a href="/tag/primes" rel="tag">primes</a>, <a href="/tag/puzzles" rel="tag">puzzles</a>, <a href="/tag/python" rel="tag">python</a>, <a href="/tag/recommended" rel="tag">recommended</a>, <a href="/tag/recursion" rel="tag">recursion</a>, <a href="/tag/regex" rel="tag">regex</a>, <a href="/tag/reviews" rel="tag">reviews</a>, <a href="/tag/ruby" rel="tag">ruby</a>, <a href="/tag/ruby-on-rails" rel="tag">ruby-on-rails</a>, <a href="/tag/scheme" rel="tag">scheme</a>, <a href="/tag/scrum" rel="tag">scrum</a>, <a href="/tag/self" rel="tag">self</a>, <a href="/tag/shell" rel="tag">shell</a>, <a href="/tag/sicp" rel="tag">sicp</a>, <a href="/tag/spolsky" rel="tag">spolsky</a>, <a href="/tag/steganography" rel="tag">steganography</a>, <a href="/tag/streams" rel="tag">streams</a>, <a href="/tag/subversion" rel="tag">subversion</a>, <a href="/tag/swansea" rel="tag">swansea</a>, <a href="/tag/syntax" rel="tag">syntax</a>, <a href="/tag/talks" rel="tag">talks</a>, <a href="/tag/teamwork" rel="tag">teamwork</a>, <a href="/tag/tesseract" rel="tag">tesseract</a>, <a href="/tag/tests" rel="tag">tests</a>, <a href="/tag/torvalds" rel="tag">torvalds</a>, <a href="/tag/trac" rel="tag">trac</a>, <a href="/tag/turing" rel="tag">turing</a>, <a href="/tag/two-wheels" rel="tag">two-wheels</a>, <a href="/tag/unicode" rel="tag">unicode</a>, <a href="/tag/unix" rel="tag">unix</a>, <a href="/tag/virtualization" rel="tag">virtualization</a>, <a href="/tag/web-applications" rel="tag">web-applications</a>, <a href="/tag/webapplications" rel="tag">webapplications</a>, <a href="/tag/windows" rel="tag">windows</a>, <a href="/tag/zlib" rel="tag">zlib</a></p>

</div>

<div class="sidebar-node">
<h3>Articles</h3>
<ul>
<li><a href="/articles/">Ordered by date</a></li>
<li><a href="/articles/alphabetical-order/">Alphabetical order</a></li>
</ul>


</div>

<div class="sidebar-node">
<h3>Chain</h3>
<ul>
<li><a accesskey="p" href="/articles/meetup-turn-up" title="First article">&raquo; Meetup? Turn Up!</a></li>

</ul>


</div>

    </div>
  </div>
  <div id="footer">
<hr />
<p><a href="http://tag.wordaligned.org">Thomas Guest</a></p>
</div>

</div>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-3373724-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
  })();
</script>
</body>

</html>
